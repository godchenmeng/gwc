<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.youxing.car.dao.GpsDao">
	<resultMap type="com.youxing.car.entity.Gps" id="GpsRM">
		<id column="id" property="id" />
		<result column="device" property="device" />
		<result column="serial" property="serial" />
		<result column="obd_type" property="obd_type" />
		<result column="data_flow" property="data_flow" />
		<result column="dianya" property="dianya" />
		<result column="mileage_type" property="mileage_type" />
		<result column="mileage" property="mileage" />
		<result column="fuel" property="fuel" />
		<result column="engine_speed" property="engine_speed" />
		<result column="car_speed" property="car_speed" />
		<result column="sky_flow" property="sky_flow" />
		<result column="inlet" property="inlet" />
		<result column="inlet_pass" property="inlet_pass" />
		<result column="fault_status" property="fault_status" />
		<result column="engine_fault" property="engine_fault" />
		<result column="coolant" property="coolant" />
		<result column="car_tempu" property="car_tempu" />
		<result column="oil_pass" property="oil_pass" />
		<result column="air_pass" property="air_pass" />
		<result column="air_sensor" property="air_sensor" />
		<result column="gas_position" property="gas_position" />
		<result column="engine_time" property="engine_time" />
		<result column="fault_mil" property="fault_mil" />
		<result column="innage" property="innage" />
		<result column="engine_load" property="engine_load" />
		<result column="long_fuel" property="long_fuel" />
		<result column="angle_engine" property="angle_engine" />
		<result column="car_mileage" property="car_mileage" />
		<result column="car_time" property="car_time" />
		<result column="mean1" property="mean1" />
		<result column="mean2" property="mean2" />
		<result column="mean3" property="mean3" />
		<result column="mean4" property="mean4" />
		<result column="total_max" property="total_max" />
		<result column="senddate" property="senddate" />
		<result column="createdate" property="createdate" />
		<result column="alm_id" property="alm_id" />
		<result column="gps_status" property="gps_status" />
		<result column="latitude" property="latitude" />
		<result column="longitude" property="longitude" />
		<result column="altitude" property="altitude" />
		<result column="satellites" property="satellites" />
		<result column="gps_speed" property="gps_speed" />
		<result column="direction" property="direction" />
		<result column="pdop" property="pdop" />
		<result column="acc" property="acc" />
        <result column="car_no" property="car_no" />
        <result column="car_type" property="car_type" />
        <result column="org_id" property="org_id" />
        <result column="org" property="org" />
        <result column="start_latitude" property="start_latitude" />
        <result column="start_longitude" property="start_longitude" />
        <result column="startdate" property="startdate" />
        <result column="moment_fuel" property="moment_fuel"/>
		<result column="turn_state" property="turn_state" />
		<result column="water_level" property="water_level" />
		<result column="fuel_level" property="fuel_level" />
	</resultMap>
	<resultMap type="com.youxing.car.entity.CarMessage" id="CarMessageRM">
		<result column="acc" property="acc" />
		<result column="senddate" property="senddate" />
		<result column="latitude" property="latitude" />
		<result column="longitude" property="longitude" />
		<result column="car_speed" property="speed" />
		<result column="direction" property="direction" />
		<result column="device" property="device" />
	</resultMap>
	<!-- _____________________________________________________________________________ 全部字段 -->
	<sql id="COLUMNS">
		id,device,serial,obd_type,data_flow,dianya,mileage_type,mileage,fuel,engine_speed,car_speed,sky_flow,inlet,inlet_pass,fault_status,engine_fault,coolant,car_tempu,oil_pass,air_pass,air_sensor,
		gas_position,engine_time,fault_mil,innage,engine_load,long_fuel,angle_engine,car_mileage,car_time,mean1,mean2,mean3,mean4,total_max,senddate,createdate,alm_id,gps_status,latitude,longitude,altitude,
		satellites,gps_speed,direction,pdop,acc,water_level,fuel_level,turn_state
	</sql>


	<!-- _____________________________________________________________________________ 1.add -->

	<insert id="add" parameterType="com.youxing.car.entity.Gps">
	 	<selectKey resultType="java.lang.Long" keyProperty="id" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
		insert into yx_gps (
			<if test="device != null ">device ,</if>
			<if test="serial != null ">serial ,</if>
			<if test="obd_type != null ">obd_type ,</if>
			<if test="data_flow != null ">data_flow ,</if>
			<if test="dianya != null ">dianya ,</if>
			<if test="mileage_type != null ">mileage_type ,</if>
			<if test="mileage != null ">mileage ,</if>
			<if test="fuel != null ">fuel ,</if>
			<if test="engine_speed != null ">engine_speed ,</if>
			<if test="car_speed != null ">car_speed ,</if>
			<if test="sky_flow != null ">sky_flow ,</if>
			<if test="inlet != null ">inlet ,</if>
			<if test="inlet_pass != null ">inlet_pass ,</if>
			<if test="fault_status != null ">fault_status ,</if>
			<if test="engine_fault != null ">engine_fault ,</if>
			<if test="coolant != null ">coolant ,</if>
			<if test="car_tempu != null ">car_tempu ,</if>
			<if test="oil_pass != null ">oil_pass ,</if>
			<if test="air_pass != null ">air_pass ,</if>
			<if test="air_sensor != null ">air_sensor ,</if>
			<if test="gas_position != null ">gas_position ,</if>
			<if test="engine_time != null ">engine_time ,</if>
			<if test="fault_mil != null ">fault_mil ,</if>
			<if test="innage != null ">innage ,</if>
			<if test="engine_load != null ">engine_load ,</if>
			<if test="long_fuel != null ">long_fuel ,</if>
			<if test="angle_engine != null ">angle_engine ,</if>
			<if test="car_mileage != null ">car_mileage ,</if>
			<if test="car_time != null ">car_time ,</if>
			<if test="mean1 != null ">mean1 ,</if>
			<if test="mean2 != null ">mean2 ,</if>
			<if test="mean3 != null ">mean3 ,</if>
			<if test="mean4 != null ">mean4 ,</if>
			<if test="total_max != null ">total_max ,</if>
			<if test="senddate != null ">senddate ,</if>
			<if test="createdate != null ">createdate ,</if>
			<if test="alm_id != null ">alm_id ,</if>
			<if test="gps_status != null ">gps_status ,</if>
			<if test="latitude != null ">latitude ,</if>
			<if test="longitude != null ">longitude ,</if>
			<if test="altitude != null ">altitude ,</if>
			<if test="satellites != null ">satellites ,</if>
			<if test="gps_speed != null ">gps_speed ,</if>
			<if test="direction != null ">direction ,</if>
			<if test="pdop != null ">pdop ,</if>
			<if test="acc != null ">acc </if>
		)
		values (
			<if test="device != null"> #{device},</if>
			<if test="serial != null"> #{serial},</if>
			<if test="obd_type != null"> #{obd_type},</if>
			<if test="data_flow != null"> #{data_flow},</if>
			<if test="dianya != null"> #{dianya},</if>
			<if test="mileage_type != null"> #{mileage_type},</if>
			<if test="mileage != null"> #{mileage},</if>
			<if test="fuel != null"> #{fuel},</if>
			<if test="engine_speed != null"> #{engine_speed},</if>
			<if test="car_speed != null"> #{car_speed},</if>
			<if test="sky_flow != null"> #{sky_flow},</if>
			<if test="inlet != null"> #{inlet},</if>
			<if test="inlet_pass != null"> #{inlet_pass},</if>
			<if test="fault_status != null"> #{fault_status},</if>
			<if test="engine_fault != null"> #{engine_fault},</if>
			<if test="coolant != null"> #{coolant},</if>
			<if test="car_tempu != null"> #{car_tempu},</if>
			<if test="oil_pass != null"> #{oil_pass},</if>
			<if test="air_pass != null"> #{air_pass},</if>
			<if test="air_sensor != null"> #{air_sensor},</if>
			<if test="gas_position != null"> #{gas_position},</if>
			<if test="engine_time != null"> #{engine_time},</if>
			<if test="fault_mil != null"> #{fault_mil},</if>
			<if test="innage != null"> #{innage},</if>
			<if test="engine_load != null"> #{engine_load},</if>
			<if test="long_fuel != null"> #{long_fuel},</if>
			<if test="angle_engine != null"> #{angle_engine},</if>
			<if test="car_mileage != null"> #{car_mileage},</if>
			<if test="car_time != null"> #{car_time},</if>
			<if test="mean1 != null"> #{mean1},</if>
			<if test="mean2 != null"> #{mean2},</if>
			<if test="mean3 != null"> #{mean3},</if>
			<if test="mean4 != null"> #{mean4},</if>
			<if test="total_max != null"> #{total_max},</if>
			<if test="senddate != null"> #{senddate},</if>
			<if test="createdate != null"> #{createdate},</if>
			<if test="alm_id != null"> #{alm_id},</if>
			<if test="gps_status != null"> #{gps_status},</if>
			<if test="latitude != null"> #{latitude},</if>
			<if test="longitude != null"> #{longitude},</if>
			<if test="altitude != null"> #{altitude},</if>
			<if test="satellites != null"> #{satellites},</if>
			<if test="gps_speed != null"> #{gps_speed},</if>
			<if test="direction != null"> #{direction},</if>
			<if test="pdop != null"> #{pdop},</if>
			<if test="acc != null"> #{acc}</if>
		)
	</insert>

	<!-- ______________________________________________________________________________ 2.modify -->

	<update id="modify" parameterType="com.youxing.car.entity.Gps">
		update yx_gps 
		<set>
			<if test="device != null">device = #{device},</if>
			<if test="serial != null">serial = #{serial},</if>
			<if test="obd_type != null">obd_type = #{obd_type},</if>
			<if test="data_flow != null">data_flow = #{data_flow},</if>
			<if test="dianya != null">dianya = #{dianya},</if>
			<if test="mileage_type != null">mileage_type = #{mileage_type},</if>
			<if test="mileage != null">mileage = #{mileage},</if>
			<if test="fuel != null">fuel = #{fuel},</if>
			<if test="engine_speed != null">engine_speed = #{engine_speed},</if>
			<if test="car_speed != null">car_speed = #{car_speed},</if>
			<if test="sky_flow != null">sky_flow = #{sky_flow},</if>
			<if test="inlet != null">inlet = #{inlet},</if>
			<if test="inlet_pass != null">inlet_pass = #{inlet_pass},</if>
			<if test="fault_status != null">fault_status = #{fault_status},</if>
			<if test="engine_fault != null">engine_fault = #{engine_fault},</if>
			<if test="coolant != null">coolant = #{coolant},</if>
			<if test="car_tempu != null">car_tempu = #{car_tempu},</if>
			<if test="oil_pass != null">oil_pass = #{oil_pass},</if>
			<if test="air_pass != null">air_pass = #{air_pass},</if>
			<if test="air_sensor != null">air_sensor = #{air_sensor},</if>
			<if test="gas_position != null">gas_position = #{gas_position},</if>
			<if test="engine_time != null">engine_time = #{engine_time},</if>
			<if test="fault_mil != null">fault_mil = #{fault_mil},</if>
			<if test="innage != null">innage = #{innage},</if>
			<if test="engine_load != null">engine_load = #{engine_load},</if>
			<if test="long_fuel != null">long_fuel = #{long_fuel},</if>
			<if test="angle_engine != null">angle_engine = #{angle_engine},</if>
			<if test="car_mileage != null">car_mileage = #{car_mileage},</if>
			<if test="car_time != null">car_time = #{car_time},</if>
			<if test="mean1 != null">mean1 = #{mean1},</if>
			<if test="mean2 != null">mean2 = #{mean2},</if>
			<if test="mean3 != null">mean3 = #{mean3},</if>
			<if test="mean4 != null">mean4 = #{mean4},</if>
			<if test="total_max != null">total_max = #{total_max},</if>
			<if test="senddate != null">senddate = #{senddate},</if>
			<if test="createdate != null">createdate = #{createdate},</if>
			<if test="alm_id != null">alm_id = #{alm_id},</if>
			<if test="gps_status != null">gps_status = #{gps_status},</if>
			<if test="latitude != null">latitude = #{latitude},</if>
			<if test="longitude != null">longitude = #{longitude},</if>
			<if test="altitude != null">altitude = #{altitude},</if>
			<if test="satellites != null">satellites = #{satellites},</if>
			<if test="gps_speed != null">gps_speed = #{gps_speed},</if>
			<if test="direction != null">direction = #{direction},</if>
			<if test="pdop != null">pdop = #{pdop},</if>
			<if test="acc != null">acc = #{acc}</if>
		</set>
		where id = #{id}
	</update>

	<!-- _____________________________________________________________________________ 3.removeById -->

	<delete id="removeById" parameterType="long">
		delete from yx_gps where id=#{id} 
	</delete>

	<!-- _____________________________________________________________________________ 4.removeByIds -->

	<delete id="removeByIds" parameterType="List">
		delete from yx_gps where id in 
		<foreach collection = "list" index="index"  item="id" open="(" separator="," close=")">
			#{id}
		</foreach>
	</delete>

	<!-- _____________________________________________________________________________ 5.listAll -->

	<select id="listAll" resultMap="GpsRM">
		select <include refid="COLUMNS" /> from yx_gps
	</select>

	<!-- _____________________________________________________________________________ 6.listBy -->

	<select id="listBy" parameterType="map" resultMap="GpsRM">
		select <include refid="COLUMNS" /> from yx_gps
		<where>
			<if test="id != null">and id = #{id}</if>
			<if test="device != null">and device = #{device}</if>
			<if test="serial != null">and serial = #{serial}</if>
			<if test="obd_type != null">and obd_type = #{obd_type}</if>
			<if test="data_flow != null">and data_flow = #{data_flow}</if>
			<if test="dianya != null">and dianya = #{dianya}</if>
			<if test="mileage_type != null">and mileage_type = #{mileage_type}</if>
			<if test="mileage != null">and mileage = #{mileage}</if>
			<if test="fuel != null">and fuel = #{fuel}</if>
			<if test="engine_speed != null">and engine_speed = #{engine_speed}</if>
			<if test="car_speed != null">and car_speed = #{car_speed}</if>
			<if test="sky_flow != null">and sky_flow = #{sky_flow}</if>
			<if test="inlet != null">and inlet = #{inlet}</if>
			<if test="inlet_pass != null">and inlet_pass = #{inlet_pass}</if>
			<if test="fault_status != null">and fault_status = #{fault_status}</if>
			<if test="engine_fault != null">and engine_fault = #{engine_fault}</if>
			<if test="coolant != null">and coolant = #{coolant}</if>
			<if test="car_tempu != null">and car_tempu = #{car_tempu}</if>
			<if test="oil_pass != null">and oil_pass = #{oil_pass}</if>
			<if test="air_pass != null">and air_pass = #{air_pass}</if>
			<if test="air_sensor != null">and air_sensor = #{air_sensor}</if>
			<if test="gas_position != null">and gas_position = #{gas_position}</if>
			<if test="engine_time != null">and engine_time = #{engine_time}</if>
			<if test="fault_mil != null">and fault_mil = #{fault_mil}</if>
			<if test="innage != null">and innage = #{innage}</if>
			<if test="engine_load != null">and engine_load = #{engine_load}</if>
			<if test="long_fuel != null">and long_fuel = #{long_fuel}</if>
			<if test="angle_engine != null">and angle_engine = #{angle_engine}</if>
			<if test="car_mileage != null">and car_mileage = #{car_mileage}</if>
			<if test="car_time != null">and car_time = #{car_time}</if>
			<if test="mean1 != null">and mean1 = #{mean1}</if>
			<if test="mean2 != null">and mean2 = #{mean2}</if>
			<if test="mean3 != null">and mean3 = #{mean3}</if>
			<if test="mean4 != null">and mean4 = #{mean4}</if>
			<if test="total_max != null">and total_max = #{total_max}</if>
			<if test="senddate != null">and senddate = #{senddate}</if>
			<if test="createdate != null">and createdate = #{createdate}</if>
			<if test="alm_id != null">and alm_id = #{alm_id}</if>
			<if test="gps_status != null">and gps_status = #{gps_status}</if>
			<if test="latitude != null">and latitude = #{latitude}</if>
			<if test="longitude != null">and longitude = #{longitude}</if>
			<if test="altitude != null">and altitude = #{altitude}</if>
			<if test="satellites != null">and satellites = #{satellites}</if>
			<if test="gps_speed != null">and gps_speed = #{gps_speed}</if>
			<if test="direction != null">and direction = #{direction}</if>
			<if test="pdop != null">and pdop = #{pdop}</if>
			<if test="acc != null">and acc = #{acc}</if>
		</where>
	</select>

	<!-- _____________________________________________________________________________ 7.pageBy -->

	<select id="pageBy" parameterType="map" resultMap="GpsRM">
		select <include refid="COLUMNS" /> from yx_gps
		<where>
			<if test="id != null">and id = #{id}</if>
			<if test="device != null">and device = #{device}</if>
			<if test="serial != null">and serial = #{serial}</if>
			<if test="obd_type != null">and obd_type = #{obd_type}</if>
			<if test="data_flow != null">and data_flow = #{data_flow}</if>
			<if test="dianya != null">and dianya = #{dianya}</if>
			<if test="mileage_type != null">and mileage_type = #{mileage_type}</if>
			<if test="mileage != null">and mileage = #{mileage}</if>
			<if test="fuel != null">and fuel = #{fuel}</if>
			<if test="engine_speed != null">and engine_speed = #{engine_speed}</if>
			<if test="car_speed != null">and car_speed = #{car_speed}</if>
			<if test="sky_flow != null">and sky_flow = #{sky_flow}</if>
			<if test="inlet != null">and inlet = #{inlet}</if>
			<if test="inlet_pass != null">and inlet_pass = #{inlet_pass}</if>
			<if test="fault_status != null">and fault_status = #{fault_status}</if>
			<if test="engine_fault != null">and engine_fault = #{engine_fault}</if>
			<if test="coolant != null">and coolant = #{coolant}</if>
			<if test="car_tempu != null">and car_tempu = #{car_tempu}</if>
			<if test="oil_pass != null">and oil_pass = #{oil_pass}</if>
			<if test="air_pass != null">and air_pass = #{air_pass}</if>
			<if test="air_sensor != null">and air_sensor = #{air_sensor}</if>
			<if test="gas_position != null">and gas_position = #{gas_position}</if>
			<if test="engine_time != null">and engine_time = #{engine_time}</if>
			<if test="fault_mil != null">and fault_mil = #{fault_mil}</if>
			<if test="innage != null">and innage = #{innage}</if>
			<if test="engine_load != null">and engine_load = #{engine_load}</if>
			<if test="long_fuel != null">and long_fuel = #{long_fuel}</if>
			<if test="angle_engine != null">and angle_engine = #{angle_engine}</if>
			<if test="car_mileage != null">and car_mileage = #{car_mileage}</if>
			<if test="car_time != null">and car_time = #{car_time}</if>
			<if test="mean1 != null">and mean1 = #{mean1}</if>
			<if test="mean2 != null">and mean2 = #{mean2}</if>
			<if test="mean3 != null">and mean3 = #{mean3}</if>
			<if test="mean4 != null">and mean4 = #{mean4}</if>
			<if test="total_max != null">and total_max = #{total_max}</if>
			<if test="senddate != null">and senddate = #{senddate}</if>
			<if test="createdate != null">and createdate = #{createdate}</if>
			<if test="alm_id != null">and alm_id = #{alm_id}</if>
			<if test="gps_status != null">and gps_status = #{gps_status}</if>
			<if test="latitude != null">and latitude = #{latitude}</if>
			<if test="longitude != null">and longitude = #{longitude}</if>
			<if test="altitude != null">and altitude = #{altitude}</if>
			<if test="satellites != null">and satellites = #{satellites}</if>
			<if test="gps_speed != null">and gps_speed = #{gps_speed}</if>
			<if test="direction != null">and direction = #{direction}</if>
			<if test="pdop != null">and pdop = #{pdop}</if>
			<if test="acc != null">and acc = #{acc}</if>
			<if test="senddate_lte != null">and senddate &lt;= #{senddate_lte}</if>
		</where>
		order by senddate desc
		limit #{startIdx},#{limit}
	</select>

	<!-- _____________________________________________________________________________ 8.1.findByMap -->

	<select id="findByMap" parameterType="map" resultMap="GpsRM">
		select <include refid="COLUMNS" /> from yx_gps
		<where>
			<if test="id != null">and id = #{id}</if>
			<if test="device != null">and device = #{device}</if>
			<if test="serial != null">and serial = #{serial}</if>
			<if test="obd_type != null">and obd_type = #{obd_type}</if>
			<if test="data_flow != null">and data_flow = #{data_flow}</if>
			<if test="dianya != null">and dianya = #{dianya}</if>
			<if test="mileage_type != null">and mileage_type = #{mileage_type}</if>
			<if test="mileage != null">and mileage = #{mileage}</if>
			<if test="fuel != null">and fuel = #{fuel}</if>
			<if test="engine_speed != null">and engine_speed = #{engine_speed}</if>
			<if test="car_speed != null">and car_speed = #{car_speed}</if>
			<if test="sky_flow != null">and sky_flow = #{sky_flow}</if>
			<if test="inlet != null">and inlet = #{inlet}</if>
			<if test="inlet_pass != null">and inlet_pass = #{inlet_pass}</if>
			<if test="fault_status != null">and fault_status = #{fault_status}</if>
			<if test="engine_fault != null">and engine_fault = #{engine_fault}</if>
			<if test="coolant != null">and coolant = #{coolant}</if>
			<if test="car_tempu != null">and car_tempu = #{car_tempu}</if>
			<if test="oil_pass != null">and oil_pass = #{oil_pass}</if>
			<if test="air_pass != null">and air_pass = #{air_pass}</if>
			<if test="air_sensor != null">and air_sensor = #{air_sensor}</if>
			<if test="gas_position != null">and gas_position = #{gas_position}</if>
			<if test="engine_time != null">and engine_time = #{engine_time}</if>
			<if test="fault_mil != null">and fault_mil = #{fault_mil}</if>
			<if test="innage != null">and innage = #{innage}</if>
			<if test="engine_load != null">and engine_load = #{engine_load}</if>
			<if test="long_fuel != null">and long_fuel = #{long_fuel}</if>
			<if test="angle_engine != null">and angle_engine = #{angle_engine}</if>
			<if test="car_mileage != null">and car_mileage = #{car_mileage}</if>
			<if test="car_time != null">and car_time = #{car_time}</if>
			<if test="mean1 != null">and mean1 = #{mean1}</if>
			<if test="mean2 != null">and mean2 = #{mean2}</if>
			<if test="mean3 != null">and mean3 = #{mean3}</if>
			<if test="mean4 != null">and mean4 = #{mean4}</if>
			<if test="total_max != null">and total_max = #{total_max}</if>
			<if test="senddate != null">and senddate = #{senddate}</if>
			<if test="createdate != null">and createdate = #{createdate}</if>
			<if test="alm_id != null">and alm_id = #{alm_id}</if>
			<if test="gps_status != null">and gps_status = #{gps_status}</if>
			<if test="latitude != null">and latitude = #{latitude}</if>
			<if test="longitude != null">and longitude = #{longitude}</if>
			<if test="altitude != null">and altitude = #{altitude}</if>
			<if test="satellites != null">and satellites = #{satellites}</if>
			<if test="gps_speed != null">and gps_speed = #{gps_speed}</if>
			<if test="direction != null">and direction = #{direction}</if>
			<if test="pdop != null">and pdop = #{pdop}</if>
			<if test="acc != null">and acc = #{acc}</if>
		</where>
	</select>

	<!-- _____________________________________________________________________________ 8.2.findBy -->

	<select id="findBy" parameterType="com.youxing.car.entity.Gps" resultMap="GpsRM">
		select <include refid="COLUMNS" /> from yx_gps
		<where>
			<if test="id != null">and id = #{id}</if>
			<if test="device != null">and device = #{device}</if>
			<if test="serial != null">and serial = #{serial}</if>
			<if test="obd_type != null">and obd_type = #{obd_type}</if>
			<if test="data_flow != null">and data_flow = #{data_flow}</if>
			<if test="dianya != null">and dianya = #{dianya}</if>
			<if test="mileage_type != null">and mileage_type = #{mileage_type}</if>
			<if test="mileage != null">and mileage = #{mileage}</if>
			<if test="fuel != null">and fuel = #{fuel}</if>
			<if test="engine_speed != null">and engine_speed = #{engine_speed}</if>
			<if test="car_speed != null">and car_speed = #{car_speed}</if>
			<if test="sky_flow != null">and sky_flow = #{sky_flow}</if>
			<if test="inlet != null">and inlet = #{inlet}</if>
			<if test="inlet_pass != null">and inlet_pass = #{inlet_pass}</if>
			<if test="fault_status != null">and fault_status = #{fault_status}</if>
			<if test="engine_fault != null">and engine_fault = #{engine_fault}</if>
			<if test="coolant != null">and coolant = #{coolant}</if>
			<if test="car_tempu != null">and car_tempu = #{car_tempu}</if>
			<if test="oil_pass != null">and oil_pass = #{oil_pass}</if>
			<if test="air_pass != null">and air_pass = #{air_pass}</if>
			<if test="air_sensor != null">and air_sensor = #{air_sensor}</if>
			<if test="gas_position != null">and gas_position = #{gas_position}</if>
			<if test="engine_time != null">and engine_time = #{engine_time}</if>
			<if test="fault_mil != null">and fault_mil = #{fault_mil}</if>
			<if test="innage != null">and innage = #{innage}</if>
			<if test="engine_load != null">and engine_load = #{engine_load}</if>
			<if test="long_fuel != null">and long_fuel = #{long_fuel}</if>
			<if test="angle_engine != null">and angle_engine = #{angle_engine}</if>
			<if test="car_mileage != null">and car_mileage = #{car_mileage}</if>
			<if test="car_time != null">and car_time = #{car_time}</if>
			<if test="mean1 != null">and mean1 = #{mean1}</if>
			<if test="mean2 != null">and mean2 = #{mean2}</if>
			<if test="mean3 != null">and mean3 = #{mean3}</if>
			<if test="mean4 != null">and mean4 = #{mean4}</if>
			<if test="total_max != null">and total_max = #{total_max}</if>
			<if test="senddate != null">and senddate = #{senddate}</if>
			<if test="createdate != null">and createdate = #{createdate}</if>
			<if test="alm_id != null">and alm_id = #{alm_id}</if>
			<if test="gps_status != null">and gps_status = #{gps_status}</if>
			<if test="latitude != null">and latitude = #{latitude}</if>
			<if test="longitude != null">and longitude = #{longitude}</if>
			<if test="altitude != null">and altitude = #{altitude}</if>
			<if test="satellites != null">and satellites = #{satellites}</if>
			<if test="gps_speed != null">and gps_speed = #{gps_speed}</if>
			<if test="direction != null">and direction = #{direction}</if>
			<if test="pdop != null">and pdop = #{pdop}</if>
			<if test="acc != null">and acc = #{acc}</if>
		</where>
	</select>

	<!-- _____________________________________________________________________________ 9.findById -->

	<select id="findById" parameterType="long" resultMap="GpsRM">
		select <include refid="COLUMNS" /> from yx_gps where id = #{id}
	</select>

	<!-- _____________________________________________________________________________ 10.countAll -->

	<select id="countAll" resultType="integer">
		select count(id) from yx_gps
	</select>

	<!-- _____________________________________________________________________________ 11.countBy -->

	<select id="countBy" parameterType="map" resultType="integer">
		select count(id) from yx_gps
		<where>
			<if test="id != null">and id = #{id}</if>
			<if test="device != null">and device = #{device}</if>
			<if test="serial != null">and serial = #{serial}</if>
			<if test="obd_type != null">and obd_type = #{obd_type}</if>
			<if test="data_flow != null">and data_flow = #{data_flow}</if>
			<if test="dianya != null">and dianya = #{dianya}</if>
			<if test="mileage_type != null">and mileage_type = #{mileage_type}</if>
			<if test="mileage != null">and mileage = #{mileage}</if>
			<if test="fuel != null">and fuel = #{fuel}</if>
			<if test="engine_speed != null">and engine_speed = #{engine_speed}</if>
			<if test="car_speed != null">and car_speed = #{car_speed}</if>
			<if test="sky_flow != null">and sky_flow = #{sky_flow}</if>
			<if test="inlet != null">and inlet = #{inlet}</if>
			<if test="inlet_pass != null">and inlet_pass = #{inlet_pass}</if>
			<if test="fault_status != null">and fault_status = #{fault_status}</if>
			<if test="engine_fault != null">and engine_fault = #{engine_fault}</if>
			<if test="coolant != null">and coolant = #{coolant}</if>
			<if test="car_tempu != null">and car_tempu = #{car_tempu}</if>
			<if test="oil_pass != null">and oil_pass = #{oil_pass}</if>
			<if test="air_pass != null">and air_pass = #{air_pass}</if>
			<if test="air_sensor != null">and air_sensor = #{air_sensor}</if>
			<if test="gas_position != null">and gas_position = #{gas_position}</if>
			<if test="engine_time != null">and engine_time = #{engine_time}</if>
			<if test="fault_mil != null">and fault_mil = #{fault_mil}</if>
			<if test="innage != null">and innage = #{innage}</if>
			<if test="engine_load != null">and engine_load = #{engine_load}</if>
			<if test="long_fuel != null">and long_fuel = #{long_fuel}</if>
			<if test="angle_engine != null">and angle_engine = #{angle_engine}</if>
			<if test="car_mileage != null">and car_mileage = #{car_mileage}</if>
			<if test="car_time != null">and car_time = #{car_time}</if>
			<if test="mean1 != null">and mean1 = #{mean1}</if>
			<if test="mean2 != null">and mean2 = #{mean2}</if>
			<if test="mean3 != null">and mean3 = #{mean3}</if>
			<if test="mean4 != null">and mean4 = #{mean4}</if>
			<if test="total_max != null">and total_max = #{total_max}</if>
			<if test="senddate != null">and senddate = #{senddate}</if>
			<if test="createdate != null">and createdate = #{createdate}</if>
			<if test="alm_id != null">and alm_id = #{alm_id}</if>
			<if test="gps_status != null">and gps_status = #{gps_status}</if>
			<if test="latitude != null">and latitude = #{latitude}</if>
			<if test="longitude != null">and longitude = #{longitude}</if>
			<if test="altitude != null">and altitude = #{altitude}</if>
			<if test="satellites != null">and satellites = #{satellites}</if>
			<if test="gps_speed != null">and gps_speed = #{gps_speed}</if>
			<if test="direction != null">and direction = #{direction}</if>
			<if test="pdop != null">and pdop = #{pdop}</if>
			<if test="acc != null">and acc = #{acc}</if>
		</where>
	</select>
	<!-- ******************扩展Mapper****************** -->
<!-- 	<select id="findListByDevice" parameterType="map" resultMap="GpsRM">
	    select c.type as car_type,c.id as car_id,c.car_no,ygc.device,ygc.senddate,ygc.latitude,ygc.longitude,ygc.car_speed,
	    (case when ygc.acc = '0' then '0'
		when ygc.acc = '1' and (TIMESTAMPDIFF(MINUTE, ygc.senddate,now()) &gt; 5) then '2'
		when ygc.acc = '1' and (TIMESTAMPDIFF(MINUTE, ygc.senddate,now()) &lt; 5) then '1'
		 end) 'acc',
		 ygc.direction,o.id org_id,o.name org,n.startdate,n.latitude start_latitude,n.longitude start_longitude,ygc.gps_speed,
		(ygc.fuel-n.fuel)/1000 as moment_fuel,ygc.mileage
		from yx_gps_current ygc
		left join (select device,MAX(senddate) as senddate from yx_gps_current
		group by device) t on t.device = ygc.device
		left join (select device,MAX(senddate) startdate,latitude,longitude,fuel from yx_car_notice where acc = 1 group by device) n on n.device = ygc.device
		left join yx_device d on d.device = ygc.device
		left join yx_car c on c.id = d.car_id
		left join yx_org o on o.id = c.org
		where c.status = '1' and o.status = '1'
		<if test="devices != null"> and ygc.device in
			<foreach collection="devices" item="item" index="index" open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>
	</select> -->
		<select id="findListByDevice" parameterType="map" resultMap="GpsRM">
	    select c.type as car_type,c.id as car_id,c.car_no,ygc.device,ygc.senddate,ygc.latitude,ygc.longitude,ygc.car_speed,
	    (case 
				when (TIMESTAMPDIFF(MINUTE, ygc.senddate,now()) &gt;5) then '0'
				when ygc.acc = '0' then '0'
				when ygc.acc = '1' and (TIMESTAMPDIFF(MINUTE, ygc.senddate,now()) &lt;=5) and car_speed =0 then '2'
				when ygc.acc = '1' and (TIMESTAMPDIFF(MINUTE, ygc.senddate,now()) &lt;=5) and car_speed &gt;0 then '1'
				 end) 'acc',
		 ygc.direction,o.id org_id,o.name org,ygc.gps_speed,ygc.mileage,n.latitude start_latitude,n.longitude start_longitude,n.startdate startdate,
		 d.video_device,
	     c.tank_vol as total_oil,
		  ROUND((case when ygc.fuel_level &lt; 0 then null else ygc.fuel_level end) * c.tank_vol / c.tank_height) as remain_oil,
	     (case
	        when ygc.turn_state = '3' then '0'
	        when ygc.turn_state = '1' then '1'
	        when ygc.turn_state = '2' then '2'
	      end) as turn_state
		from yx_gps_current ygc
				left join (SELECT
				device,
				latitude,
				longitude,
				senddate startdate
			FROM
				(
					SELECT
						device,
						latitude,
						longitude,
						senddate
					FROM
						yx_car_notice
					WHERE
						alm_id = '0001'
					ORDER BY
						senddate DESC
				) t
			GROUP BY device) n on n.device = ygc.device
		left join yx_device d on d.device = ygc.device
		left join yx_car c on c.id = d.car_id
		left join yx_org o on o.id = c.org
		where c.status = '1' and o.status = '1' and d.status = '1' and c.obd = '1' and c.car_status = '1'
		<if test="devices != null"> and ygc.device in
			<foreach collection="devices" item="item" index="index" open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>
	</select>
	<select id="findListForCarCurrentLine" parameterType="map" resultMap="GpsRM">
		select car_speed,latitude,longitude,direction,senddate,mileage
		from yx_gps
		where senddate >= (select max(senddate) from yx_car_notice where device = #{device} and alm_id = 0001)
		and device = #{device}
		order by senddate ASC
	</select>
	<select id="findGpsCurrentByDevice" parameterType="map" resultType="carMessage">
		select 
				(case 
				when yps.acc = '0' then '0'
				when yps.acc = '1' and (TIMESTAMPDIFF(MINUTE, yps.senddate,now()) &gt;5) then '2'
				when yps.acc = '1' and (TIMESTAMPDIFF(MINUTE, yps.senddate,now()) &lt;5) then '1'
				 end) 'acc',
				yc.id id,
				ydc.text as car_type,
				yc.type,
				yc.self_num,
				yd.device,
				yps.direction,
				ROUND(((yps.car_mileage - yc.mileage)/1000),2) as car_mileage,
			    ROUND((yps.fuel/1000),2) as fuel,
				yps.dianya,
				yps.engine_speed,
				yps.coolant,
				yps.car_tempu,
				yps.car_speed,
				yps.latitude,
				yps.longitude,
				yps.senddate,
				yc.car_no,
				yo.name as orgName,
				yc.id as car_id,
				yc.tank_vol as total_oil,
		  ROUND((case when yps.fuel_level &lt; 0 then null else yps.fuel_level end) * yc.tank_vol / yc.tank_height) as remain_oil,
	     (case
	        when yps.turn_state = '3' then '0'
	        when yps.turn_state = '1' then '1'
	        when yps.turn_state = '2' then '2'
	      end) as turn_state
				from yx_gps_current yps 
				left join yx_device yd  on yps.device = yd.device
				left join yx_car yc on  yc.id = yd.car_id
				left join  yx_org  yo on yo.id = yc.org
				left join yx_dictionary ydc on ydc.value = yc.type and ydc.parent_id = '1'
				where yd.status = '1' and yc.status = '1' and yc.obd = '1' and yc.car_status = '1' and yo.status = '1'
         <if test="org_list != null"> and yo.id in
            <foreach collection="org_list" item="item" index="index" open="(" separator="," close=")">
                #{item}
            </foreach>
         </if>
	     <if test="type != null">and yc.type = #{type}</if>
	     <if test="device != null">and yd.device=#{device}</if>
    	     order by yps.senddate desc
	</select>
	
	
	<!-- ===========================web -->
	<select id="findListForCarMessage" parameterType="map" resultType="CarMessage">
	    select ygc.device,ygc.senddate,ygc.latitude,ygc.longitude,ygc.acc,ygc.direction,ygc.car_speed
		from yx_gps_current ygc,
		    (select device,MAX(senddate) as senddate
		     from yx_gps_current
		     where 1=1
		     <if test="devices != null"> and device in
		         <foreach collection="devices" item="item" index="index" open="(" separator="," close=")">
				    #{item}
	             </foreach>
		     </if>
		     group by device) t
	    where ygc.device = t.device
	      and ygc.senddate = t.senddate
	</select>
	
	
<!-- 	<select id="getCarStatus" parameterType="map" resultMap="GpsRM">
	    select DISTINCT(device) as device,senddate,
		(case when acc = '0' then '0'
     	 when acc = '1' and (TIMESTAMPDIFF(MINUTE, senddate,now()) > 5) then '2' 
     	 when acc = '1' then '1' end) 'acc'
     	  from yx_gps_current yg  where  yg.device in
			(select yd.device 
			from yx_device yd
 			left join yx_car yc  on yc.id = yd.car_id 
	    where yc.status = '1' and yc.car_status = '1' and yc.obd = '1'
	    <if test="list2 != null"> and yc.org in
	        <foreach collection="list2" item="item" index="index" open="(" separator="," close=")">
				#{item}
		    </foreach>
	    </if>
	    )
	</select> -->
		<select id="getCarStatus" parameterType="map" resultMap="GpsRM">
	    select DISTINCT(yg.device) as device,senddate,
		(case 
				when (TIMESTAMPDIFF(MINUTE, yg.senddate,now()) &gt;5) then '0'
				when yg.acc = '0' then '0'
				when yg.acc = '1' and (TIMESTAMPDIFF(MINUTE, yg.senddate,now()) &lt;=5) and car_speed =0 then '2'
				when yg.acc = '1' and (TIMESTAMPDIFF(MINUTE, yg.senddate,now()) &lt;=5) and car_speed &gt;0 then '1'
				 end) 'acc'
     	  from yx_gps_current yg  
		left join yx_device yd  on yg.device = yd.device
		left join yx_car yc on  yc.id = yd.car_id
		left join  yx_org  yo on yo.id = yc.org     	  
     	  where  
	    yd.status = '1' and yc.status = '1' and yc.obd = '1' and yc.car_status = '1' and yo.status = '1'
	    <if test="list2 != null"> and yc.org in
	        <foreach collection="list2" item="item" index="index" open="(" separator="," close=")">
				#{item}
		    </foreach>
	    </if>
	</select>
	
	<!-- 查询三日，7日，一直无数据的设备信息 -->
	<!-- 三日-7日无数据 -->
	<select id="getDeviceByThree" parameterType="map" resultType="java.util.HashMap" statementType="STATEMENT">
		select 
			<if test="col_str != null and col_str != ''">${col_str}</if>
			from yx_device yd 
			left join yx_gps_current ygs  on yd.device = ygs.device
			left join yx_car yc    on yc.id = yd.car_id
			left join yx_org yo    on yo.id = yc.org
			left join yx_dictionary ydi on yc.type = ydi.value and ydi.parent_id = 1
			where 
			yc.status = 1 and 
			yo.status = 1 and 
			yd.status = 1 and 
			(TIMESTAMPDIFF(Day,ygs.createdate,NOW())) &gt;= 3 and 
			(TIMESTAMPDIFF(Day,ygs.createdate,NOW())) &lt; 7
			<if test="org_list != null"> and yo.id in
				<foreach collection="org_list" item="item" index="index" open="(" separator="," close=")">
					${item}
				</foreach>
			</if>
			order by yo.id,ygs.senddate desc
		limit ${startIdx},${limit}
	</select>
	
	<select id="getDeviceByThreeNum" parameterType="map" resultType="Integer">
	select count(*) from (
		select 
			TIMESTAMPDIFF(Day,ygs.senddate,NOW()) as day,
			yd.device,
			yc.car_no,
			yo.name,
			yd.sim,
			ygs.senddate
			from yx_device yd 
			left join yx_gps_current ygs  on yd.device = ygs.device
			left join yx_car yc    on yc.id = yd.car_id
			left join yx_org yo    on yo.id = yc.org
			left join yx_dictionary ydi on yc.type = ydi.value and ydi.parent_id = 1
			where 
			yc.status = 1 and 
			yo.status = 1 and 
			yd.status = 1 and 
			(TIMESTAMPDIFF(Day,ygs.createdate,NOW())) &gt;= 3 and 
			(TIMESTAMPDIFF(Day,ygs.createdate,NOW())) &lt; 7
			<if test="org_list != null"> and yo.id in
				<foreach collection="org_list" item="item" index="index" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
		) tt
	</select>
	
		<!-- 三日-7日无数据 -->
	<select id="getDeviceByThreeEx" parameterType="map" resultType="java.util.LinkedHashMap" statementType="STATEMENT">
		select 
			<if test="col_str != null and col_str != ''">${col_str}</if>
			from yx_device yd 
			left join yx_gps_current ygs  on yd.device = ygs.device
			left join yx_car yc    on yc.id = yd.car_id
			left join yx_org yo    on yo.id = yc.org
			left join yx_dictionary ydi on yc.type = ydi.value and ydi.parent_id = 1
			where 
			yc.status = 1 and 
			yo.status = 1 and 
			yd.status = 1 and 
			(TIMESTAMPDIFF(Day,ygs.createdate,NOW())) &gt;= 3 and 
			(TIMESTAMPDIFF(Day,ygs.createdate,NOW())) &lt; 7
			<if test="org_list != null"> and yo.id in
				<foreach collection="org_list" item="item" index="index" open="(" separator="," close=")">
					${item}
				</foreach>
			</if>
			order by yo.id,ygs.senddate desc
	</select>
	
	<!-- 7日以上无 -->
	<select id="getDeviceBySeven" parameterType="map" resultType="java.util.HashMap" statementType="STATEMENT">
	   select 
			<if test="col_str != null and col_str != ''">${col_str}</if>
			from yx_device yd 
			left join yx_gps_current ygs  on yd.device = ygs.device
			left join yx_car yc    on yc.id = yd.car_id
			left join yx_org yo    on yo.id = yc.org
			left join yx_dictionary ydi on yc.type = ydi.value and ydi.parent_id = 1
			where yc.status = 1 and yo.status = 1 and yd.status = 1
			and 
			(TIMESTAMPDIFF(Day,ygs.createdate,NOW())) &gt;= 7 
			<if test="org_list != null"> and yo.id in
				<foreach collection="org_list" item="item" index="index" open="(" separator="," close=")">
					${item}
				</foreach>
			</if>
			order by yo.id,ygs.senddate desc
			limit ${startIdx},${limit}
	</select>
	
	<select id="getDeviceBySevenNum" parameterType="map" resultType="Integer">
	select count(*) from (
	   select 
			TIMESTAMPDIFF(Day,ygs.senddate,NOW()) as day,
			yd.device,
			yc.car_no,
			yo.name,
			yd.sim,
			ygs.senddate
			from yx_device yd 
			left join yx_gps_current ygs  on yd.device = ygs.device
			left join yx_car yc    on yc.id = yd.car_id
			left join yx_org yo    on yo.id = yc.org
			left join yx_dictionary ydi on yc.type = ydi.value and ydi.parent_id = 1
			where yc.status = 1 and yo.status = 1 and yd.status = 1
			and 
			(TIMESTAMPDIFF(Day,ygs.createdate,NOW())) &gt;= 7 
			<if test="org_list != null"> and yo.id in
				<foreach collection="org_list" item="item" index="index" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			) tt
	</select>
	
	<select id="getDeviceBySevenEx" parameterType="map" resultType="java.util.LinkedHashMap" statementType="STATEMENT">
	   select 
			<if test="col_str != null and col_str != ''">${col_str}</if>
			from yx_device yd 
			left join yx_gps_current ygs  on yd.device = ygs.device
			left join yx_car yc    on yc.id = yd.car_id
			left join yx_org yo    on yo.id = yc.org
			left join yx_dictionary ydi on yc.type = ydi.value and ydi.parent_id = 1
			where yc.status = 1 and yo.status = 1 and yd.status = 1
			and 
			(TIMESTAMPDIFF(Day,ygs.createdate,NOW())) &gt;= 7 
			<if test="org_list != null"> and yo.id in
				<foreach collection="org_list" item="item" index="index" open="(" separator="," close=")">
					${item}
				</foreach>
			</if>
			order by yo.id,ygs.senddate desc
	</select>
	
	<!-- 一直日无 -->
	<select id="getDeviceByNever" parameterType="map" resultType="java.util.HashMap" statementType="STATEMENT">
		select 
		<if test="col_str != null and col_str != ''">${col_str}</if>
			from  yx_device yd 
			left join yx_car yc on yc.id = yd.car_id
			left join yx_org yo on yo.id = yc.org
			left join yx_dictionary ydi on yc.type = ydi.value and ydi.parent_id = 1
		where 
			yd.device not in (select device from yx_gps_current )
			and 
			yc.status = 1 and 
			yo.status = 1 and 
			yd.status = 1
			<if test="org_list != null"> and yo.id in
				<foreach collection="org_list" item="item" index="index" open="(" separator="," close=")">
					${item}
				</foreach>
			</if>
			order by yo.id
		limit ${startIdx},${limit}
	</select>
	
	<select id="getDeviceByNeverNum" parameterType="map" resultType="Integer">
	select count(*)  from (
		select 
			yd.device,
			yc.car_no,
			yo.name  
			from  yx_device yd 
			left join yx_car yc on yc.id = yd.car_id
			left join yx_org yo on yo.id = yc.org
			left join yx_dictionary ydi on yc.type = ydi.value and ydi.parent_id = 1
		where 
			yd.device not in (select device from yx_gps_current )
			and 
			yc.status = 1 and 
			yo.status = 1 and 
			yd.status = 1
			<if test="org_list != null"> and yo.id in
				<foreach collection="org_list" item="item" index="index" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			) tt
	</select>
	
	<select id="getDeviceByNeverEx" parameterType="map" resultType="java.util.LinkedHashMap" statementType="STATEMENT">
		select 
			<if test="col_str != null and col_str != ''">${col_str}</if>
			from  yx_device yd 
			left join yx_car yc on yc.id = yd.car_id
			left join yx_org yo on yo.id = yc.org
			left join yx_dictionary ydi on yc.type = ydi.value and ydi.parent_id = 1
		where 
			yd.device not in (select device from yx_gps_current )
			and 
			yc.status = 1 and 
			yo.status = 1 and 
			yd.status = 1
			<if test="org_list != null"> and yo.id in
				<foreach collection="org_list" item="item" index="index" open="(" separator="," close=")">
					${item}
				</foreach>
			</if>
			order by yo.id
	</select>
	<select id="findListForTrack" parameterType="map" resultMap="GpsRM">
		select left(senddate,19) senddate,	id,device,serial,obd_type,data_flow,dianya,mileage_type,mileage,fuel,
		engine_speed,car_speed,sky_flow,inlet,inlet_pass,fault_status,engine_fault,
		coolant,car_tempu,oil_pass,air_pass,air_sensor,gas_position,engine_time,
		fault_mil,innage,engine_load,long_fuel,angle_engine,car_mileage,car_time,mean1,
		mean2,mean3,mean4,total_max,acc,createdate,alm_id,gps_status,latitude,
		longitude,altitude,satellites,gps_speed,direction,pdop
		from yx_gps
		where 1=1
		<if test="device != null">and device = #{device}</if>
		<if test="startTime != null">and senddate &gt;= #{startTime}</if>
		<if test="endTime != null">and senddate &lt;= #{endTime}</if>
		<if test="devices != null">and device in
			<foreach collection="devices" item="item" index="index" open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>
		order by senddate asc
	</select>

	<select id="findNewGPSInfo" parameterType="string" resultMap="GpsRM">
		select <include refid="COLUMNS" /> from yx_gps
		<where>
			device = #{device}
		</where>
		order by senddate desc
		limit 1
	</select>
	
</mapper>
